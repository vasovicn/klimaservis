module.exports=[67025,a=>{"use strict";a.s(["SERVICES",0,[{id:"mali",name:"Mali servis",price:"4.000",priceValue:4e3,duration:30,description:"Osnovno čišćenje i provera klima uređaja",features:["Čišćenje filtera","Provera nivoa freona","Dezinfekcija unutrašnje jedinice","Vizuelna kontrola sistema"]},{id:"veliki",name:"Veliki servis",price:"7.000",priceValue:7e3,duration:60,description:"Kompletno čišćenje i održavanje klima uređaja",features:["Kompletno čišćenje unutrašnje jedinice","Čišćenje spoljašnje jedinice","Dopuna freona","Dezinfekcija i antibakterijski tretman","Provera svih komponenti"]},{id:"kondenzator",name:"Zamena kondenzatora",price:"5.000",priceValue:5e3,duration:45,description:"Dijagnostika i zamena kondenzatora",features:["Dijagnostika kvara","Zamena kondenzatora","Testiranje sistema","Garancija na rad"]}]])},44568,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(67025);function e({onClose:a,onCreated:e,prefillServiserId:f,prefillDate:g,prefillTime:h}){let[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(g||""),[o,p]=(0,c.useState)(h||""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(f||""),[y,z]=(0,c.useState)(30),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(""),E=k.includes("ostalo");(0,c.useEffect)(()=>{fetch("/api/admin/users").then(a=>a.json()).then(a=>{let b=(a.users||[]).filter(a=>"serviser"===a.role&&!1!==a.active);j(b),!w&&b.length>0&&x(b[0].id)})},[w]);let F=a=>{l(b=>b.includes(a)?b.filter(b=>b!==a):[...b,a])},G=async a=>{a.preventDefault(),B(!0),D("");try{let a=await fetch("/api/admin/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({services:k,date:m,startTime:o,customerName:q,customerPhone:s,customerAddress:u,userId:w,...E?{customDuration:y}:{}})});if(!a.ok){let b=await a.json();D(b.error||"Greška");return}e()}catch{D("Greška pri povezivanju")}finally{B(!1)}};return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:(0,b.jsxs)("div",{className:"w-full max-w-md max-h-[90vh] overflow-y-auto rounded-2xl bg-white p-6 shadow-xl",children:[(0,b.jsx)("h3",{className:"mb-4 text-lg font-bold text-gray-900",children:"Novo zakazivanje"}),(0,b.jsxs)("form",{onSubmit:G,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Usluge"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[d.SERVICES.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>F(a.id),className:`rounded-full px-3 py-1 text-sm font-medium transition-colors ${k.includes(a.id)?"bg-brand-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:a.name},a.id)),(0,b.jsx)("button",{type:"button",onClick:()=>F("ostalo"),className:`rounded-full px-3 py-1 text-sm font-medium transition-colors ${E?"bg-brand-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Ostalo"})]})]}),E&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Trajanje (minuti)"}),(0,b.jsx)("input",{type:"number",value:y,onChange:a=>z(Number(a.target.value)),min:15,step:15,required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Datum"}),(0,b.jsx)("input",{type:"date",value:m,onChange:a=>n(a.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Vreme"}),(0,b.jsx)("input",{type:"time",value:o,onChange:a=>p(a.target.value),step:"1800",required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Serviser"}),(0,b.jsx)("select",{value:w,onChange:a=>x(a.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500",children:i.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.firstName," ",a.lastName]},a.id))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Ime i prezime"}),(0,b.jsx)("input",{type:"text",value:q,onChange:a=>r(a.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Telefon"}),(0,b.jsx)("input",{type:"tel",value:s,onChange:a=>t(a.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Adresa"}),(0,b.jsx)("input",{type:"text",value:u,onChange:a=>v(a.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),C&&(0,b.jsx)("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-600",children:C}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{type:"submit",disabled:A||0===k.length,className:"flex-1 rounded-lg bg-brand-500 py-2.5 text-sm font-semibold text-white hover:bg-brand-600 disabled:bg-gray-300",children:A?"Čuvanje...":"Zakaži"}),(0,b.jsx)("button",{type:"button",onClick:a,className:"flex-1 rounded-lg bg-gray-100 py-2.5 text-sm font-semibold text-gray-700 hover:bg-gray-200",children:"Otkaži"})]})]})]})})}a.s(["default",()=>e])},13181,a=>{"use strict";var b=a.i(87924),c=a.i(72131);let d={confirmed:"bg-brand-100 text-brand-700",completed:"bg-green-100 text-green-700",cancelled:"bg-gray-100 text-gray-500"},e={confirmed:"Potvrđeno",completed:"Završeno",cancelled:"Otkazano"},f=["Nedelja","Ponedeljak","Utorak","Sreda","Četvrtak","Petak","Subota"],g=["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"];function h({refreshKey:a}){let[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!0),l=(0,c.useCallback)(()=>{k(!0),fetch("/api/admin/bookings").then(a=>a.json()).then(a=>i(a.bookings||[])).finally(()=>k(!1))},[]);(0,c.useEffect)(()=>{l()},[l,a]);let m=async(a,b)=>{await fetch(`/api/admin/bookings/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:b})}),l()},n=(0,c.useMemo)(()=>{let a={};for(let b of h)a[b.date]||(a[b.date]=[]),a[b.date].push(b);return Object.keys(a).sort((a,b)=>b.localeCompare(a)).map(b=>{let c,d,e,h,i,j,k,l;return{date:b,label:(d=f[(c=new Date(b+"T00:00:00")).getDay()],e=c.getDate(),h=g[c.getMonth()],i=c.getFullYear(),(j=new Date).setHours(0,0,0,0),k=Math.round((c.getTime()-j.getTime())/864e5),l=`${d}, ${e}. ${h} ${i}`,0===k?l+=" (Danas)":1===k?l+=" (Sutra)":-1===k&&(l+=" (Juče)"),l),bookings:a[b].sort((a,b)=>a.startTime.localeCompare(b.startTime))}})},[h]);return j?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-brand-200 border-t-brand-500"})}):0===h.length?(0,b.jsx)("div",{className:"py-12 text-center text-gray-500",children:"Nema zakazivanja."}):(0,b.jsx)("div",{className:"space-y-6",children:n.map(a=>(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"mb-2 text-sm font-semibold text-gray-700",children:a.label}),(0,b.jsx)("div",{className:"overflow-x-auto rounded-xl border border-gray-200 bg-white",children:(0,b.jsxs)("table",{className:"w-full min-w-[800px] text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-gray-200 bg-gray-50",children:[(0,b.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Vreme"}),(0,b.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Klijent"}),(0,b.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Telefon"}),(0,b.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Adresa"}),(0,b.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Usluge"}),(0,b.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Serviser"}),(0,b.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Status"}),(0,b.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Akcije"})]})}),(0,b.jsx)("tbody",{children:a.bookings.map(a=>(0,b.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,b.jsxs)("td",{className:"px-4 py-2.5 whitespace-nowrap",children:[a.startTime," - ",a.endTime]}),(0,b.jsx)("td",{className:"px-4 py-2.5 font-medium",children:a.customerName}),(0,b.jsx)("td",{className:"px-4 py-2.5",children:a.customerPhone}),(0,b.jsx)("td",{className:"px-4 py-2.5 max-w-[200px] truncate",children:a.customerAddress}),(0,b.jsx)("td",{className:"px-4 py-2.5",children:(a=>{try{let b=JSON.parse(a),c={mali:"Mali",veliki:"Veliki",kondenzator:"Kondenzator",ostalo:"Ostalo"};return b.map(a=>c[a]||a).join(", ")}catch{return a}})(a.services)}),(0,b.jsxs)("td",{className:"px-4 py-2.5",children:[a.user.firstName," ",a.user.lastName]}),(0,b.jsx)("td",{className:"px-4 py-2.5",children:(0,b.jsx)("span",{className:`inline-block rounded-full px-2 py-0.5 text-xs font-medium ${d[a.status]||""}`,children:e[a.status]||a.status})}),(0,b.jsx)("td",{className:"px-4 py-2.5",children:"confirmed"===a.status&&(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)("button",{onClick:()=>m(a.id,"completed"),className:"rounded bg-green-100 px-2 py-1 text-xs font-medium text-green-700 hover:bg-green-200",children:"Završi"}),(0,b.jsx)("button",{onClick:()=>m(a.id,"cancelled"),className:"rounded bg-red-100 px-2 py-1 text-xs font-medium text-red-700 hover:bg-red-200",children:"Otkaži"})]})})]},a.id))})]})})]},a.date))})}var i=a.i(44568);function j(){let[a,d]=(0,c.useState)(!1),[e,f]=(0,c.useState)(0);return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Zakazivanja"}),(0,b.jsx)("button",{onClick:()=>d(!0),className:"rounded-lg bg-brand-500 px-4 py-2 text-sm font-semibold text-white hover:bg-brand-600",children:"+ Novo zakazivanje"})]}),(0,b.jsx)(h,{refreshKey:e}),a&&(0,b.jsx)(i.default,{onClose:()=>d(!1),onCreated:()=>{d(!1),f(a=>a+1)}})]})}a.s(["default",()=>j],13181)}];

//# sourceMappingURL=src_d727df34._.js.map