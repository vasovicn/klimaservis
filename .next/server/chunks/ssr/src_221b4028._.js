module.exports=[67025,a=>{"use strict";a.s(["SERVICES",0,[{id:"mali",name:"Mali servis",price:"4.000",priceValue:4e3,duration:30,description:"Osnovno čišćenje i provera klima uređaja",features:["Čišćenje filtera","Provera nivoa freona","Dezinfekcija unutrašnje jedinice","Vizuelna kontrola sistema"]},{id:"veliki",name:"Veliki servis",price:"7.000",priceValue:7e3,duration:60,description:"Kompletno čišćenje i održavanje klima uređaja",features:["Kompletno čišćenje unutrašnje jedinice","Čišćenje spoljašnje jedinice","Dopuna freona","Dezinfekcija i antibakterijski tretman","Provera svih komponenti"]},{id:"kondenzator",name:"Zamena kondenzatora",price:"5.000",priceValue:5e3,duration:45,description:"Dijagnostika i zamena kondenzatora",features:["Dijagnostika kvara","Zamena kondenzatora","Testiranje sistema","Garancija na rad"]}]])},44568,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(67025);function e({onClose:a,onCreated:e,prefillServiserId:f,prefillDate:g,prefillTime:h}){let[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(g||""),[o,p]=(0,c.useState)(h||""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(f||""),[y,z]=(0,c.useState)(30),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(""),E=k.includes("ostalo");(0,c.useEffect)(()=>{fetch("/api/admin/users").then(a=>a.json()).then(a=>{let b=(a.users||[]).filter(a=>"serviser"===a.role&&!1!==a.active);j(b),!w&&b.length>0&&x(b[0].id)})},[w]);let F=a=>{l(b=>b.includes(a)?b.filter(b=>b!==a):[...b,a])},G=async a=>{a.preventDefault(),B(!0),D("");try{let a=await fetch("/api/admin/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({services:k,date:m,startTime:o,customerName:q,customerPhone:s,customerAddress:u,userId:w,...E?{customDuration:y}:{}})});if(!a.ok){let b=await a.json();D(b.error||"Greška");return}e()}catch{D("Greška pri povezivanju")}finally{B(!1)}};return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:(0,b.jsxs)("div",{className:"w-full max-w-md max-h-[90vh] overflow-y-auto rounded-2xl bg-white p-6 shadow-xl",children:[(0,b.jsx)("h3",{className:"mb-4 text-lg font-bold text-gray-900",children:"Novo zakazivanje"}),(0,b.jsxs)("form",{onSubmit:G,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Usluge"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[d.SERVICES.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>F(a.id),className:`rounded-full px-3 py-1 text-sm font-medium transition-colors ${k.includes(a.id)?"bg-brand-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:a.name},a.id)),(0,b.jsx)("button",{type:"button",onClick:()=>F("ostalo"),className:`rounded-full px-3 py-1 text-sm font-medium transition-colors ${E?"bg-brand-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Ostalo"})]})]}),E&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Trajanje (minuti)"}),(0,b.jsx)("input",{type:"number",value:y,onChange:a=>z(Number(a.target.value)),min:15,step:15,required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Datum"}),(0,b.jsx)("input",{type:"date",value:m,onChange:a=>n(a.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Vreme"}),(0,b.jsx)("input",{type:"time",value:o,onChange:a=>p(a.target.value),step:"1800",required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Serviser"}),(0,b.jsx)("select",{value:w,onChange:a=>x(a.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500",children:i.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.firstName," ",a.lastName]},a.id))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Ime i prezime"}),(0,b.jsx)("input",{type:"text",value:q,onChange:a=>r(a.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Telefon"}),(0,b.jsx)("input",{type:"tel",value:s,onChange:a=>t(a.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Adresa"}),(0,b.jsx)("input",{type:"text",value:u,onChange:a=>v(a.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),C&&(0,b.jsx)("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-600",children:C}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{type:"submit",disabled:A||0===k.length,className:"flex-1 rounded-lg bg-brand-500 py-2.5 text-sm font-semibold text-white hover:bg-brand-600 disabled:bg-gray-300",children:A?"Čuvanje...":"Zakaži"}),(0,b.jsx)("button",{type:"button",onClick:a,className:"flex-1 rounded-lg bg-gray-100 py-2.5 text-sm font-semibold text-gray-700 hover:bg-gray-200",children:"Otkaži"})]})]})]})})}a.s(["default",()=>e])},67168,a=>{"use strict";var b=a.i(87924),c=a.i(72131);let d=["Ned","Pon","Uto","Sre","Čet","Pet","Sub"],e=["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"];function f(a){let b=a.getFullYear(),c=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0");return`${b}-${c}-${d}`}function g({selectedDate:a,onSelect:c}){let g=new Date,h=new Date(a+"T00:00:00"),i=Math.max(0,Math.floor((h.getTime()-g.getTime())/864e5)-3),j=[];for(let a=0;a<7;a++){let b=new Date(g);b.setDate(g.getDate()+i+a),j.push(b)}return(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>{let a=new Date(h);a.setDate(a.getDate()-1),a>=g&&c(f(a))},className:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-600",children:(0,b.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),(0,b.jsx)("div",{className:"flex gap-2 overflow-x-auto",children:j.map(g=>{let h,i=f(g),j=i===a,k=(h=new Date,g.getFullYear()===h.getFullYear()&&g.getMonth()===h.getMonth()&&g.getDate()===h.getDate());return(0,b.jsxs)("button",{onClick:()=>c(i),className:`flex min-w-[4.5rem] flex-col items-center rounded-xl px-3 py-2 text-sm transition-all ${j?"bg-brand-500 text-white shadow-md":k?"border-2 border-brand-500 bg-white text-brand-600":"bg-white text-gray-600 hover:bg-gray-50"}`,children:[(0,b.jsx)("span",{className:"text-xs font-medium",children:d[g.getDay()]}),(0,b.jsx)("span",{className:"text-lg font-bold",children:g.getDate()}),(0,b.jsx)("span",{className:"text-xs",children:e[g.getMonth()]})]},i)})}),(0,b.jsx)("button",{onClick:()=>{let a=new Date(h);a.setDate(a.getDate()+1),c(f(a))},className:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-600",children:(0,b.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})})]})}let h={confirmed:"bg-brand-500 border-brand-600 text-white",completed:"bg-green-500 border-green-600 text-white"};function i({booking:a,rowHeight:c,onClick:d}){let e,f=function(a,b){let[c,d]=a.split(":").map(Number),[e,f]=b.split(":").map(Number);return Math.max(Math.round((60*e+f-(60*c+d))/30),1)}(a.startTime,a.endTime);try{let b=JSON.parse(a.services),c={mali:"Mali servis",veliki:"Veliki servis",kondenzator:"Kondenzator",ostalo:"Ostalo"};e=b.map(a=>c[a]||a).join(", ")}catch{e=a.services}return(0,b.jsxs)("div",{onClick:a=>{a.stopPropagation(),d?.()},className:`absolute inset-x-1 top-0 cursor-pointer overflow-hidden rounded-lg border px-2 py-1 text-xs shadow-sm transition-opacity hover:opacity-90 ${h[a.status]||h.confirmed}`,style:{height:`${f*c}px`,zIndex:10},children:[(0,b.jsx)("div",{className:"font-semibold truncate",children:a.customerName}),(0,b.jsx)("div",{className:"truncate opacity-80",children:e}),(0,b.jsxs)("div",{className:"opacity-80",children:[a.startTime," - ",a.endTime]})]})}let j=[];for(let a=7;a<22;a++)j.push(`${String(a).padStart(2,"0")}:00`),j.push(`${String(a).padStart(2,"0")}:30`);function k({date:a,onCellClick:d}){let[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)([]),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(!1),w=(0,c.useCallback)(()=>{l(!0),fetch(`/api/admin/schedule?date=${a}`).then(a=>a.json()).then(a=>{f(a.servisers||[]),h(a.bookings||[])}).finally(()=>l(!1))},[a]);(0,c.useEffect)(()=>{w()},[w]);let x=async()=>{m&&(v(!0),await fetch(`/api/admin/bookings/${m.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerName:o,customerPhone:q,customerAddress:s})}),v(!1),n(null),w())},y=async()=>{m&&(await fetch(`/api/admin/bookings/${m.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"cancelled"})}),n(null),w())};return k?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-brand-200 border-t-brand-500"})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"overflow-x-auto rounded-xl border border-gray-200 bg-white",children:(0,b.jsxs)("table",{className:"w-full min-w-[600px]",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-gray-200 bg-gray-50",children:[(0,b.jsx)("th",{className:"w-20 px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Vreme"}),e.map(a=>(0,b.jsxs)("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500",children:[a.firstName," ",a.lastName]},a.id))]})}),(0,b.jsx)("tbody",{children:j.map((a,c)=>(0,b.jsxs)("tr",{className:`border-b border-gray-100 ${c%2==0?"bg-white":"bg-gray-50/50"}`,children:[(0,b.jsx)("td",{className:"px-3 text-xs text-gray-500 whitespace-nowrap",style:{height:"40px"},children:a}),e.map(c=>{let e=g.filter(b=>b.userId===c.id&&b.startTime===a);return(0,b.jsx)("td",{className:"relative cursor-pointer px-1",style:{height:"40px"},onClick:()=>0===e.length&&d?.(c.id,a),children:e.map(a=>(0,b.jsx)(i,{booking:a,rowHeight:40,onClick:()=>{n(a),p(a.customerName),r(a.customerPhone),t(a.customerAddress)}},a.id))},c.id)})]},a))})]})}),m&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:(0,b.jsxs)("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-xl",children:[(0,b.jsx)("h3",{className:"mb-4 text-lg font-bold text-gray-900",children:"Detalji zakazivanja"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"rounded-lg bg-gray-50 p-3 space-y-1 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Usluge:"}),(0,b.jsx)("span",{className:"font-medium",children:(a=>{try{let b=JSON.parse(a),c={mali:"Mali servis",veliki:"Veliki servis",kondenzator:"Kondenzator",ostalo:"Ostalo"};return b.map(a=>c[a]||a).join(", ")}catch{return a}})(m.services)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Vreme:"}),(0,b.jsxs)("span",{className:"font-medium",children:[m.startTime," - ",m.endTime]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Trajanje:"}),(0,b.jsxs)("span",{className:"font-medium",children:[m.duration," min"]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Status:"}),(0,b.jsx)("span",{className:`font-medium ${"confirmed"===m.status?"text-brand-600":"text-green-600"}`,children:"confirmed"===m.status?"Potvrđeno":"Završeno"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Ime i prezime"}),(0,b.jsx)("input",{type:"text",value:o,onChange:a=>p(a.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Telefon"}),(0,b.jsx)("input",{type:"tel",value:q,onChange:a=>r(a.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Adresa"}),(0,b.jsx)("input",{type:"text",value:s,onChange:a=>t(a.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]})]}),(0,b.jsxs)("div",{className:"mt-5 flex gap-2",children:[(0,b.jsx)("button",{onClick:x,disabled:u,className:"flex-1 rounded-lg bg-brand-500 py-2.5 text-sm font-semibold text-white hover:bg-brand-600 disabled:bg-gray-300",children:u?"Čuvanje...":"Sačuvaj"}),"confirmed"===m.status&&(0,b.jsx)("button",{onClick:y,className:"flex-1 rounded-lg bg-red-500 py-2.5 text-sm font-semibold text-white hover:bg-red-600",children:"Otkaži termin"}),(0,b.jsx)("button",{onClick:()=>n(null),className:"flex-1 rounded-lg bg-gray-100 py-2.5 text-sm font-semibold text-gray-700 hover:bg-gray-200",children:"Zatvori"})]})]})})]})}var l=a.i(44568);function m(){let a,d,e,f,[h,i]=(0,c.useState)((d=(a=new Date).getFullYear(),e=String(a.getMonth()+1).padStart(2,"0"),f=String(a.getDate()).padStart(2,"0"),`${d}-${e}-${f}`)),[j,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)({}),[p,q]=(0,c.useState)(0);return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Raspored"}),(0,b.jsx)("button",{onClick:()=>{o({}),m(!0)},className:"rounded-lg bg-brand-500 px-4 py-2 text-sm font-semibold text-white hover:bg-brand-600",children:"+ Novo zakazivanje"})]}),(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)(g,{selectedDate:h,onSelect:i})}),(0,b.jsx)(k,{date:h,onCellClick:(a,b)=>{o({serviserId:a,time:b}),m(!0)}},`${h}-${p}`),j&&(0,b.jsx)(l.default,{onClose:()=>m(!1),onCreated:()=>{m(!1),o({}),q(a=>a+1)},prefillServiserId:n.serviserId,prefillDate:h,prefillTime:n.time})]})}a.s(["default",()=>m],67168)}];

//# sourceMappingURL=src_221b4028._.js.map