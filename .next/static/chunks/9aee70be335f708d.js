(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,12133,e=>{"use strict";e.s(["SERVICES",0,[{id:"mali",name:"Mali servis",price:"4.000",priceValue:4e3,duration:30,description:"Osnovno čišćenje i provera klima uređaja",features:["Čišćenje filtera","Provera nivoa freona","Dezinfekcija unutrašnje jedinice","Vizuelna kontrola sistema"]},{id:"veliki",name:"Veliki servis",price:"7.000",priceValue:7e3,duration:60,description:"Kompletno čišćenje i održavanje klima uređaja",features:["Kompletno čišćenje unutrašnje jedinice","Čišćenje spoljašnje jedinice","Dopuna freona","Dezinfekcija i antibakterijski tretman","Provera svih komponenti"]},{id:"kondenzator",name:"Zamena kondenzatora",price:"5.000",priceValue:5e3,duration:45,description:"Dijagnostika i zamena kondenzatora",features:["Dijagnostika kvara","Zamena kondenzatora","Testiranje sistema","Garancija na rad"]}]])},12172,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(12133);function s({onClose:e,onCreated:s,prefillServiserId:n,prefillDate:l,prefillTime:i}){let[d,o]=(0,a.useState)([]),[c,m]=(0,a.useState)([]),[u,x]=(0,a.useState)(l||""),[b,p]=(0,a.useState)(i||""),[g,h]=(0,a.useState)(""),[j,y]=(0,a.useState)(""),[f,v]=(0,a.useState)(""),[N,k]=(0,a.useState)(n||""),[w,S]=(0,a.useState)(30),[C,z]=(0,a.useState)(!1),[T,O]=(0,a.useState)(""),D=c.includes("ostalo");(0,a.useEffect)(()=>{fetch("/api/admin/users").then(e=>e.json()).then(e=>{let t=(e.users||[]).filter(e=>"serviser"===e.role&&!1!==e.active);o(t),!N&&t.length>0&&k(t[0].id)})},[N]);let P=e=>{m(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},V=async e=>{e.preventDefault(),z(!0),O("");try{let e=await fetch("/api/admin/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({services:c,date:u,startTime:b,customerName:g,customerPhone:j,customerAddress:f,userId:N,...D?{customDuration:w}:{}})});if(!e.ok){let t=await e.json();O(t.error||"Greška");return}s()}catch{O("Greška pri povezivanju")}finally{z(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-md max-h-[90vh] overflow-y-auto rounded-2xl bg-white p-6 shadow-xl",children:[(0,t.jsx)("h3",{className:"mb-4 text-lg font-bold text-gray-900",children:"Novo zakazivanje"}),(0,t.jsxs)("form",{onSubmit:V,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Usluge"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[r.SERVICES.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>P(e.id),className:`rounded-full px-3 py-1 text-sm font-medium transition-colors ${c.includes(e.id)?"bg-brand-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:e.name},e.id)),(0,t.jsx)("button",{type:"button",onClick:()=>P("ostalo"),className:`rounded-full px-3 py-1 text-sm font-medium transition-colors ${D?"bg-brand-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Ostalo"})]})]}),D&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Trajanje (minuti)"}),(0,t.jsx)("input",{type:"number",value:w,onChange:e=>S(Number(e.target.value)),min:15,step:15,required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Datum"}),(0,t.jsx)("input",{type:"date",value:u,onChange:e=>x(e.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Vreme"}),(0,t.jsx)("input",{type:"time",value:b,onChange:e=>p(e.target.value),step:"1800",required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Serviser"}),(0,t.jsx)("select",{value:N,onChange:e=>k(e.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500",children:d.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Ime i prezime"}),(0,t.jsx)("input",{type:"text",value:g,onChange:e=>h(e.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Telefon"}),(0,t.jsx)("input",{type:"tel",value:j,onChange:e=>y(e.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Adresa"}),(0,t.jsx)("input",{type:"text",value:f,onChange:e=>v(e.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-900 outline-none focus:border-brand-500"})]}),T&&(0,t.jsx)("div",{className:"rounded-lg bg-red-50 p-3 text-sm text-red-600",children:T}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{type:"submit",disabled:C||0===c.length,className:"flex-1 rounded-lg bg-brand-500 py-2.5 text-sm font-semibold text-white hover:bg-brand-600 disabled:bg-gray-300",children:C?"Čuvanje...":"Zakaži"}),(0,t.jsx)("button",{type:"button",onClick:e,className:"flex-1 rounded-lg bg-gray-100 py-2.5 text-sm font-semibold text-gray-700 hover:bg-gray-200",children:"Otkaži"})]})]})]})})}e.s(["default",()=>s])},1292,e=>{"use strict";var t=e.i(43476),a=e.i(71645);let r={confirmed:"bg-brand-100 text-brand-700",completed:"bg-green-100 text-green-700",cancelled:"bg-gray-100 text-gray-500"},s={confirmed:"Potvrđeno",completed:"Završeno",cancelled:"Otkazano"},n=["Nedelja","Ponedeljak","Utorak","Sreda","Četvrtak","Petak","Subota"],l=["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"];function i({refreshKey:e}){let[i,d]=(0,a.useState)([]),[o,c]=(0,a.useState)(!0),m=(0,a.useCallback)(()=>{c(!0),fetch("/api/admin/bookings").then(e=>e.json()).then(e=>d(e.bookings||[])).finally(()=>c(!1))},[]);(0,a.useEffect)(()=>{m()},[m,e]);let u=async(e,t)=>{await fetch(`/api/admin/bookings/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})}),m()},x=(0,a.useMemo)(()=>{let e={};for(let t of i)e[t.date]||(e[t.date]=[]),e[t.date].push(t);return Object.keys(e).sort((e,t)=>t.localeCompare(e)).map(t=>{let a,r,s,i,d,o,c,m;return{date:t,label:(r=n[(a=new Date(t+"T00:00:00")).getDay()],s=a.getDate(),i=l[a.getMonth()],d=a.getFullYear(),(o=new Date).setHours(0,0,0,0),c=Math.round((a.getTime()-o.getTime())/864e5),m=`${r}, ${s}. ${i} ${d}`,0===c?m+=" (Danas)":1===c?m+=" (Sutra)":-1===c&&(m+=" (Juče)"),m),bookings:e[t].sort((e,t)=>e.startTime.localeCompare(t.startTime))}})},[i]);return o?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-brand-200 border-t-brand-500"})}):0===i.length?(0,t.jsx)("div",{className:"py-12 text-center text-gray-500",children:"Nema zakazivanja."}):(0,t.jsx)("div",{className:"space-y-6",children:x.map(e=>(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"mb-2 text-sm font-semibold text-gray-700",children:e.label}),(0,t.jsx)("div",{className:"overflow-x-auto rounded-xl border border-gray-200 bg-white",children:(0,t.jsxs)("table",{className:"w-full min-w-[800px] text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200 bg-gray-50",children:[(0,t.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Vreme"}),(0,t.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Klijent"}),(0,t.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Telefon"}),(0,t.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Adresa"}),(0,t.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Usluge"}),(0,t.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Serviser"}),(0,t.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Status"}),(0,t.jsx)("th",{className:"px-4 py-2.5 text-left font-medium text-gray-500",children:"Akcije"})]})}),(0,t.jsx)("tbody",{children:e.bookings.map(e=>(0,t.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,t.jsxs)("td",{className:"px-4 py-2.5 whitespace-nowrap",children:[e.startTime," - ",e.endTime]}),(0,t.jsx)("td",{className:"px-4 py-2.5 font-medium",children:e.customerName}),(0,t.jsx)("td",{className:"px-4 py-2.5",children:e.customerPhone}),(0,t.jsx)("td",{className:"px-4 py-2.5 max-w-[200px] truncate",children:e.customerAddress}),(0,t.jsx)("td",{className:"px-4 py-2.5",children:(e=>{try{let t=JSON.parse(e),a={mali:"Mali",veliki:"Veliki",kondenzator:"Kondenzator",ostalo:"Ostalo"};return t.map(e=>a[e]||e).join(", ")}catch{return e}})(e.services)}),(0,t.jsxs)("td",{className:"px-4 py-2.5",children:[e.user.firstName," ",e.user.lastName]}),(0,t.jsx)("td",{className:"px-4 py-2.5",children:(0,t.jsx)("span",{className:`inline-block rounded-full px-2 py-0.5 text-xs font-medium ${r[e.status]||""}`,children:s[e.status]||e.status})}),(0,t.jsx)("td",{className:"px-4 py-2.5",children:"confirmed"===e.status&&(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:()=>u(e.id,"completed"),className:"rounded bg-green-100 px-2 py-1 text-xs font-medium text-green-700 hover:bg-green-200",children:"Završi"}),(0,t.jsx)("button",{onClick:()=>u(e.id,"cancelled"),className:"rounded bg-red-100 px-2 py-1 text-xs font-medium text-red-700 hover:bg-red-200",children:"Otkaži"})]})})]},e.id))})]})})]},e.date))})}var d=e.i(12172);function o(){let[e,r]=(0,a.useState)(!1),[s,n]=(0,a.useState)(0);return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Zakazivanja"}),(0,t.jsx)("button",{onClick:()=>r(!0),className:"rounded-lg bg-brand-500 px-4 py-2 text-sm font-semibold text-white hover:bg-brand-600",children:"+ Novo zakazivanje"})]}),(0,t.jsx)(i,{refreshKey:s}),e&&(0,t.jsx)(d.default,{onClose:()=>r(!1),onCreated:()=>{r(!1),n(e=>e+1)}})]})}e.s(["default",()=>o],1292)}]);